<!DOCTYPE html>
<html lang="es" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finx - Goals</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="trivia/shared-sidebar.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/chatbot-sidebar.css">
    <style>
        body {
            background: #E6E5E5;
        }
        [data-bs-theme="dark"] body {
            background: #181C24;
        }
        .main-section, .goals-section {
            background: linear-gradient(135deg, var(--light-background, #fff) 0%, var(--background-color, #E6E5E5) 100%);
            min-height: 100vh;
        }
        [data-bs-theme="dark"] .main-section, [data-bs-theme="dark"] .goals-section {
            background: linear-gradient(135deg, #232A36 0%, #181C24 100%);
        }
        [data-bs-theme="dark"] .trivia-sidebar {
            background: #181C24 !important;
            border-right: 1.5px solid #232A36;
        }
        .goal-title {
            font-weight: 800;
            color: #004AAD !important;
            letter-spacing: 1px;
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 2.5rem;
        }
        .goal-card {
            background: #fff !important;
            color: #002366 !important;
            border: 2px solid #004AAD !important;
            border-radius: 1.2rem !important;
            box-shadow: 0 2px 8px #00236622 !important;
            padding: 1.3rem 1.5rem 1.2rem 1.5rem !important;
            margin-bottom: 2rem !important;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .goal-card .goal-title {
            color: #004AAD !important;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .goal-card .badge {
            font-size: 0.95em;
            border-radius: 0.7em;
            padding: 0.3em 0.8em;
        }
        .goal-card .progress-bar {
            background: #E6E5E5;
            border-radius: 1rem;
            height: 0.8rem;
            margin-bottom: 0.5rem;
        }
        .goal-card .progress {
            background: #EEE95B;
            height: 100%;
            border-radius: 1rem;
            transition: width 0.5s;
        }
        .goal-card .goal-progress-text {
            color: #002366 !important;
            font-weight: 600;
            font-size: 1em;
            margin-bottom: 0.5rem;
        }
        .goal-actions {
            display: flex;
            gap: 0.7rem;
            margin-top: 0.7rem;
        }
        .goal-actions .btn {
            font-size: 1rem;
            border-radius: 0.7rem;
            padding: 0.5rem 1.3rem;
            font-weight: 700;
            box-shadow: 0 1px 4px #00236611;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        }
        .goal-actions .btn-outline-success {
            background: #EEE95B !important;
            color: #004AAD !important;
            border: none;
        }
        .goal-actions .btn-outline-success:hover {
            background: #004AAD !important;
            color: #EEE95B !important;
        }
        .goal-actions .btn-outline-danger {
            background: #fff !important;
            color: #004AAD !important;
            border: 2px solid #004AAD;
        }
        .goal-actions .btn-outline-danger:hover {
            background: #004AAD !important;
            color: #fff !important;
        }
        .form-modern h5 {
            text-align: center;
            color: #EEE95B;
            font-weight: 800;
            font-size: 2rem;
            margin-bottom: 2rem;
            letter-spacing: 1px;
        }
        .form-modern .form-label {
            color: #fff;
            font-weight: 600;
        }
        .form-modern .form-control, .form-modern .form-select {
            border-radius: 10px;
            border: 2px solid #bfc9d1;
            background: #fff;
            color: #002366;
            font-size: 1.1rem;
            padding: 0.75rem 1rem;
            margin-bottom: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-modern .form-control:focus, .form-modern .form-select:focus {
            border-color: #EEE95B;
            box-shadow: 0 0 0 2px #EEE95B44;
        }
        .form-modern .btn-primary, .modal-footer .btn-primary, .goal-actions .btn-outline-success {
            background: #EEE95B !important;
            color: #002366 !important;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: 0 2px 8px #004AAD22;
            padding: 0.7rem 2.2rem;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.2s;
        }
        .form-modern .btn-primary:hover, .modal-footer .btn-primary:hover, .goal-actions .btn-outline-success:hover {
            background: #004AAD !important;
            color: #EEE95B !important;
        }
        .form-modern .btn-secondary, .modal-footer .btn-secondary, .goal-actions .btn-outline-danger {
            background: #fff !important;
            color: #004AAD !important;
            border: 2px solid #EEE95B;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1.1rem;
            padding: 0.7rem 2.2rem;
            margin-right: 0.5rem;
            transition: background 0.2s, color 0.2s;
        }
        .form-modern .btn-secondary:hover, .modal-footer .btn-secondary:hover, .goal-actions .btn-outline-danger:hover {
            background: #EEE95B !important;
            color: #002366 !important;
        }
        /* Modal dise√±o institucional */
        .modal-header {
            border-bottom: 2px solid #EEE95B;
        }
        .modal-title {
            color: #EEE95B;
            font-weight: 800;
        }
        @media (prefers-color-scheme: dark) {
            body {
                background: #1a1d23;
            }
            .goal-card, .card.form-modern, .modal-content {
                background: #002366 !important;
                color: #fff !important;
            }
            .form-modern .form-control, .form-modern .form-select {
                background: #E6E5E5;
                color: #002366;
            }
        }
        [data-bs-theme="dark"] .navbar {
            background: #23272b !important;
            color: #EEE95B !important;
            border-bottom: 1.5px solid #EEE95B;
        }
        [data-bs-theme="dark"] .navbar .nav-link,
        [data-bs-theme="dark"] .navbar .navbar-brand,
        [data-bs-theme="dark"] .navbar .nav-link i {
            color: #EEE95B !important;
        }
        [data-bs-theme="dark"] .navbar .nav-link.active {
            color: #fff !important;
            font-weight: bold;
        }
        [data-bs-theme="dark"] .navbar .btn-primary {
            background: #EEE95B !important;
            color: #23272b !important;
            border: none;
        }
        [data-bs-theme="dark"] .navbar .btn-primary:hover {
            background: #bdb82e !important;
            color: #23272b !important;
        }
        .goal-achieved-card {
            border: 2.5px solid #004AAD;
            background: #fff;
            color: #23272b;
            font-weight: 700;
            font-size: 1.15rem;
            border-radius: 1.1rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 24px #004AAD22;
            padding: 1.1rem 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            animation: goal-shine 1.2s ease-in-out;
        }
        .goal-achieved-card .goal-emoji {
            font-size: 2rem;
            margin-right: 0.5rem;
        }
        @keyframes goal-shine {
            0% { box-shadow: 0 0 0 0 #EEE95B44; }
            60% { box-shadow: 0 0 32px 8px #EEE95B88; }
            100% { box-shadow: 0 4px 24px #004AAD22; }
        }
        [data-bs-theme="dark"] .goal-achieved-card {
            border: 2.5px solid #EEE95B;
            background: #002366;
            color: #fff;
            box-shadow: 0 4px 24px #EEE95B22;
        }
        .goal-progress-text {
            color: #fff !important;
            font-weight: 600;
        }
        .leccion-navbar {
            background: linear-gradient(135deg, var(--background-color), rgba(99, 102, 241, 0.05)) !important;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 0.15rem 0;
            min-height: 80px;
            transition: all 0.3s ease;
        }
        .leccion-navbar-brand {
            font-family: 'Montserrat', sans-serif;
            font-weight: 800;
            font-size: 1.8rem;
            background: linear-gradient(135deg, var(--fun-primary), var(--fun-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .leccion-theme-toggle {
            background: linear-gradient(135deg, var(--fun-primary), var(--fun-secondary));
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }
        .leccion-theme-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }
        :root {
            --fun-primary: #6366f1;
            --fun-secondary: #8b5cf6;
            --fun-accent: #06b6d4;
            --fun-success: #10b981;
            --fun-warning: #f59e0b;
            --fun-danger: #ef4444;
            --fun-pink: #ec4899;
            --fun-purple: #a855f7;
            --fun-orange: #f97316;
            --fun-yellow: #eab308;
        }
        [data-bs-theme="dark"] .goal-card {
            background: #fff !important;
            color: #002366 !important;
        }
        @media (prefers-color-scheme: dark) {
            .goal-card {
                background: #fff !important;
                color: #002366 !important;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar leccion-navbar" style="background: #fff !important; box-shadow: 0 4px 20px rgba(0,0,0,0.08); min-height: 70px; border-bottom: none !important;">
        <div class="container-fluid d-flex justify-content-center align-items-center" style="position:relative; min-height:70px;">
            <button class="leccion-theme-toggle d-block mx-auto" id="themeToggle" title="Change theme" style="position:relative; left:0; right:0; margin:auto; background: #818cf8; color: #fff;">
                <i class="bi bi-moon-fill" id="themeIcon" style="color: #fff;"></i>
            </button>
        </div>
    </nav>
    <style>
    [data-bs-theme="dark"] .leccion-navbar {
        background: #002366 !important;
    }
    </style>
    <!-- Sidebar -->
    <nav class="leccion-sidebar">
        <div class="container-fluid">
            <div class="text-center mb-4">
                <div class="avatar-big">
                    <i class="bi bi-person-fill"></i>
                </div>
                <h5 class="mb-0">Usuario</h5>
                <small class="text-muted">Nivel 2</small>
            </div>
            <ul class="sidebar-nav">
                <li>
                    <a href="dashboard.html">
                        <i class="bi bi-house-door-fill"></i>
                        <span>Management</span>
                    </a>
                </li>
                <li>
                    <a href="trivia/trivia.html">
                        <i class="bi bi-book-fill"></i>
                        <span>Lessons</span>
                    </a>
                </li>
                <li>
                    <a href="trivia/logros.html">
                        <i class="bi bi-trophy-fill"></i>
                        <span>Achievements</span>
                    </a>
                </li>
                <li>
                    <a href="goals.html" class="active">
                        <i class="bi bi-flag-fill"></i>
                        <span>Goals</span>
                    </a>
                </li>
                <li>
                    <a href="helpcenter2.html">
                        <i class="bi bi-question-circle-fill"></i>
                        <span>Help</span>
                    </a>
                </li>
                <li>
                    <a href="chatbot.html">
                        <i class="bi bi-robot"></i>
                        <span>Financial Assistant</span>
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-logout-container">
                <button class="btn btn-logout-icon" id="logoutBtnSidebar" title="Cerrar sesi√≥n">
                    <i class="bi bi-box-arrow-right"></i>
                </button>
            </div>
        </div>
    </nav>
    <!-- Contenido principal -->
    <main class="main-content">
        <section class="container py-5">
            <h1 class="mb-4 goal-title">My Financial Goals</h1>
            <!-- Formulario para agregar meta -->
            <div class="card p-4 mb-4" style="max-width:500px;margin:auto;">
                <h5 class="mb-3">Add New Goal</h5>
                <form id="goalForm">
                    <div class="mb-3">
                        <label for="goalName" class="form-label">Goal Name</label>
                        <input type="text" class="form-control" id="goalName" required>
                    </div>
                    <div class="mb-3">
                        <label for="goalTarget" class="form-label">Target Amount</label>
                        <input type="number" class="form-control" id="goalTarget" min="1" step="0.01" required>
                    </div>
                    <div class="mb-3">
                        <label for="goalDeadline" class="form-label">Deadline (optional)</label>
                        <input type="date" class="form-control" id="goalDeadline">
                    </div>
                    <div class="d-flex justify-content-end gap-2">
                        <button type="reset" class="btn btn-secondary">Clear</button>
                        <button type="submit" class="btn btn-primary">Add Goal</button>
                    </div>
                </form>
            </div>
            <!-- Lista de metas -->
            <div id="goalsList" class="mt-4"></div>
        </section>
        <!-- Modal para agregar ahorro -->
        <div class="modal fade" id="addSavingModal" tabindex="-1" aria-labelledby="addSavingModalLabel" aria-hidden="true" style="z-index:1055;">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addSavingModalLabel">Add Saving to Goal</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form id="addSavingForm">
                  <div class="mb-3">
                    <label for="savingAmount" class="form-label">How much do you want to add?</label>
                    <input type="number" class="form-control" id="savingAmount" min="0.01" step="0.01" required autocomplete="off">
                  </div>
                  <div class="d-flex justify-content-end gap-2">
                    <button type="button" class="btn btn-secondary btn-animated" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary btn-animated">Add</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/components.js"></script>
    <script src="js/chatbot-sidebar.js"></script>
    <script>
        // Utilidades para localStorage
        function getGoals() {
            return JSON.parse(localStorage.getItem('finx_goals') || '[]');
        }
        function saveGoals(goals) {
            localStorage.setItem('finx_goals', JSON.stringify(goals));
        }
        // Renderizar metas
        function renderGoals() {
            const goals = getGoals();
            const container = document.getElementById('goalsList');
            container.innerHTML = '';
            if (goals.length === 0) {
                container.innerHTML = '<div class="text-center text-muted">No goals yet. Add your first goal!</div>';
                return;
            }
            goals.forEach((goal, idx) => {
                const percent = Math.min(100, Math.round((goal.saved || 0) / goal.target * 100));
                let achievedCard = '';
                let actions = '';
                if ((goal.saved || 0) >= goal.target) {
                    achievedCard = `<div class="goal-achieved-card"><span class="goal-emoji">üèÜ</span>¬°Achievement reached! You can go for your <b>${goal.name}</b></div>`;
                    actions = `<button class="btn btn-sm btn-outline-danger" onclick="deleteGoal(${idx})">Delete</button>`;
                } else {
                    actions = `<button class="btn btn-sm btn-outline-success" onclick="addToGoal(${idx})">Add Saving</button>\n<button class="btn btn-sm btn-outline-danger" onclick="deleteGoal(${idx})">Delete</button>`;
                }
                container.innerHTML += `
                <div class="goal-card">
                    ${achievedCard}
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h4 class="goal-title mb-0">${goal.name}</h4>
                        <div>
                            <span class="badge bg-${percent === 100 ? 'success' : 'primary'} me-1">${percent}%</span>
                            <span class="badge bg-info text-dark">$${(goal.saved || 0).toLocaleString()}</span>
                        </div>
                    </div>
                    <div class="progress-bar mb-2">
                        <div class="progress" style="width:${percent}%;"></div>
                    </div>
                    <div class="mb-2 goal-progress-text" style="font-size:0.98em;">$${(goal.saved || 0).toLocaleString()} / $${Number(goal.target).toLocaleString()}</div>
                    ${goal.deadline ? `<div class="mb-2 text-muted" style="font-size:0.95em;">Deadline: ${goal.deadline}</div>` : ''}
                    <div class="goal-actions">
                        ${actions}
                    </div>
                </div>`;
            });
        }
        // Agregar meta
        document.getElementById('goalForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('goalName').value.trim();
            const target = parseFloat(document.getElementById('goalTarget').value);
            const deadline = document.getElementById('goalDeadline').value;
            const goals = getGoals();
            goals.push({ name, target, deadline, saved: 0 });
            saveGoals(goals);
            this.reset();
            renderGoals();
        });
        // Agregar ahorro a meta
        let savingGoalIdx = null;
        window.addToGoal = function(idx) {
            savingGoalIdx = idx;
            document.getElementById('savingAmount').value = '';
            const modalEl = document.getElementById('addSavingModal');
            const modal = new bootstrap.Modal(modalEl);
            modal.show();
        }
        document.getElementById('addSavingModal').addEventListener('shown.bs.modal', function () {
            document.getElementById('savingAmount').focus();
        });
        document.getElementById('addSavingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const num = parseFloat(document.getElementById('savingAmount').value);
            if (!isNaN(num) && num > 0 && savingGoalIdx !== null) {
                const goals = getGoals();
                goals[savingGoalIdx].saved = (goals[savingGoalIdx].saved || 0) + num;
                saveGoals(goals);
                renderGoals();
                bootstrap.Modal.getInstance(document.getElementById('addSavingModal')).hide();
            }
        });
        // Eliminar meta
        window.deleteGoal = function(idx) {
            if (confirm('Are you sure you want to delete this goal?')) {
                const goals = getGoals();
                goals.splice(idx, 1);
                saveGoals(goals);
                renderGoals();
            }
        }
        document.addEventListener('DOMContentLoaded', renderGoals);
        // Funci√≥n para cambiar tema
        function toggleTheme() {
            const html = document.documentElement;
            const icon = document.getElementById('themeIcon');
            const currentTheme = html.getAttribute('data-bs-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-bs-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            if (newTheme === 'dark') {
                icon.className = 'bi bi-sun-fill';
            } else {
                icon.className = 'bi bi-moon-fill';
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-bs-theme', savedTheme);
            const icon = document.getElementById('themeIcon');
            if (savedTheme === 'dark') {
                icon.className = 'bi bi-sun-fill';
            } else {
                icon.className = 'bi bi-moon-fill';
            }
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
        });
        document.addEventListener('DOMContentLoaded', function() {
            var logoutBtn = document.getElementById('logoutBtnSidebar');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    window.location.href = 'index.html';
                });
            }
        });
    </script>
</body>
</html> 