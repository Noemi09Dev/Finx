<!DOCTYPE html>
<html lang="es" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finx - Goals</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            background: #E6E5E5;
            padding-top: 0;
            padding-bottom: 0;
        }
        .goal-title {
            font-weight: 800;
            color: #EEE95B;
            letter-spacing: 1px;
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 2.5rem;
        }
        .goal-card {
            background: #002366;
            border-radius: 1.2rem;
            box-shadow: 0 2px 8px #00236622;
            padding: 1.5rem 1.2rem;
            margin-bottom: 1.5rem;
            border: 2px solid #004AAD;
            color: #fff;
        }
        .goal-card .badge {
            font-size: 1em;
        }
        .progress-bar {
            background: #E6E5E5;
            border-radius: 1rem;
            height: 1.2rem;
            margin-bottom: 0.5rem;
        }
        .progress {
            background: #EEE95B;
            height: 100%;
            border-radius: 1rem;
            transition: width 0.5s;
        }
        .goal-actions button {
            margin-right: 0.5rem;
        }
        .card.form-modern {
            background: #002366;
            border-radius: 18px !important;
            box-shadow: 0 8px 32px rgba(0,74,173,0.10) !important;
            border: 2px solid #004AAD !important;
            padding: 2.5rem 2rem;
            max-width: 520px;
            margin: 0 auto 2rem auto;
        }
        .form-modern h5 {
            text-align: center;
            color: #EEE95B;
            font-weight: 800;
            font-size: 2rem;
            margin-bottom: 2rem;
            letter-spacing: 1px;
        }
        .form-modern .form-label {
            color: #fff;
            font-weight: 600;
        }
        .form-modern .form-control, .form-modern .form-select {
            border-radius: 10px;
            border: 2px solid #bfc9d1;
            background: #fff;
            color: #002366;
            font-size: 1.1rem;
            padding: 0.75rem 1rem;
            margin-bottom: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-modern .form-control:focus, .form-modern .form-select:focus {
            border-color: #EEE95B;
            box-shadow: 0 0 0 2px #EEE95B44;
        }
        .form-modern .btn-primary, .modal-footer .btn-primary, .goal-actions .btn-outline-success {
            background: #EEE95B !important;
            color: #002366 !important;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: 0 2px 8px #004AAD22;
            padding: 0.7rem 2.2rem;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.2s;
        }
        .form-modern .btn-primary:hover, .modal-footer .btn-primary:hover, .goal-actions .btn-outline-success:hover {
            background: #004AAD !important;
            color: #EEE95B !important;
        }
        .form-modern .btn-secondary, .modal-footer .btn-secondary, .goal-actions .btn-outline-danger {
            background: #fff !important;
            color: #004AAD !important;
            border: 2px solid #EEE95B;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1.1rem;
            padding: 0.7rem 2.2rem;
            margin-right: 0.5rem;
            transition: background 0.2s, color 0.2s;
        }
        .form-modern .btn-secondary:hover, .modal-footer .btn-secondary:hover, .goal-actions .btn-outline-danger:hover {
            background: #EEE95B !important;
            color: #002366 !important;
        }
        /* Modal dise√±o institucional */
        .modal-content {
            background: #002366;
            border: 2px solid #004AAD;
            border-radius: 1.2rem;
            color: #fff;
        }
        .modal-header {
            border-bottom: 2px solid #EEE95B;
        }
        .modal-title {
            color: #EEE95B;
            font-weight: 800;
        }
        @media (prefers-color-scheme: dark) {
            body {
                background: #1a1d23;
            }
            .goal-card, .card.form-modern, .modal-content {
                background: #002366 !important;
                color: #fff !important;
            }
            .form-modern .form-control, .form-modern .form-select {
                background: #E6E5E5;
                color: #002366;
            }
        }
        [data-bs-theme="dark"] .navbar {
            background: #23272b !important;
            color: #EEE95B !important;
            border-bottom: 1.5px solid #EEE95B;
        }
        [data-bs-theme="dark"] .navbar .nav-link,
        [data-bs-theme="dark"] .navbar .navbar-brand,
        [data-bs-theme="dark"] .navbar .nav-link i {
            color: #EEE95B !important;
        }
        [data-bs-theme="dark"] .navbar .nav-link.active {
            color: #fff !important;
            font-weight: bold;
        }
        [data-bs-theme="dark"] .navbar .btn-primary {
            background: #EEE95B !important;
            color: #23272b !important;
            border: none;
        }
        [data-bs-theme="dark"] .navbar .btn-primary:hover {
            background: #bdb82e !important;
            color: #23272b !important;
        }
        .goal-achieved-card {
            border: 2.5px solid #004AAD;
            background: #fff;
            color: #23272b;
            font-weight: 700;
            font-size: 1.15rem;
            border-radius: 1.1rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 24px #004AAD22;
            padding: 1.1rem 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            animation: goal-shine 1.2s ease-in-out;
        }
        .goal-achieved-card .goal-emoji {
            font-size: 2rem;
            margin-right: 0.5rem;
        }
        @keyframes goal-shine {
            0% { box-shadow: 0 0 0 0 #EEE95B44; }
            60% { box-shadow: 0 0 32px 8px #EEE95B88; }
            100% { box-shadow: 0 4px 24px #004AAD22; }
        }
        [data-bs-theme="dark"] .goal-achieved-card {
            border: 2.5px solid #EEE95B;
            background: #002366;
            color: #fff;
            box-shadow: 0 4px 24px #EEE95B22;
        }
        .goal-progress-text {
            color: #fff !important;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div id="header" data-dashboard></div>
    <section class="container py-5">
        <h1 class="mb-4 goal-title">My Financial Goals</h1>
        <!-- Formulario para agregar meta -->
        <div class="card p-4 mb-4" style="max-width:500px;margin:auto;">
            <h5 class="mb-3">Add New Goal</h5>
            <form id="goalForm">
                <div class="mb-3">
                    <label for="goalName" class="form-label">Goal Name</label>
                    <input type="text" class="form-control" id="goalName" required>
                </div>
                <div class="mb-3">
                    <label for="goalTarget" class="form-label">Target Amount</label>
                    <input type="number" class="form-control" id="goalTarget" min="1" step="0.01" required>
                </div>
                <div class="mb-3">
                    <label for="goalDeadline" class="form-label">Deadline (optional)</label>
                    <input type="date" class="form-control" id="goalDeadline">
                </div>
                <div class="d-flex justify-content-end gap-2">
                    <button type="reset" class="btn btn-secondary">Clear</button>
                    <button type="submit" class="btn btn-primary">Add Goal</button>
                </div>
            </form>
        </div>
        <!-- Lista de metas -->
        <div id="goalsList" class="mt-4"></div>
    </section>
    <div id="footer"></div>
    <!-- Modal para agregar ahorro -->
    <div class="modal fade" id="addSavingModal" tabindex="-1" aria-labelledby="addSavingModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addSavingModalLabel">Add Saving to Goal</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="addSavingForm">
              <div class="mb-3">
                <label for="savingAmount" class="form-label">How much do you want to add?</label>
                <input type="number" class="form-control" id="savingAmount" min="0.01" step="0.01" required autocomplete="off">
              </div>
              <div class="d-flex justify-content-end gap-2">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary">Add</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/components.js"></script>
    <script>
        // Utilidades para localStorage
        function getGoals() {
            return JSON.parse(localStorage.getItem('finx_goals') || '[]');
        }
        function saveGoals(goals) {
            localStorage.setItem('finx_goals', JSON.stringify(goals));
        }
        // Renderizar metas
        function renderGoals() {
            const goals = getGoals();
            const container = document.getElementById('goalsList');
            container.innerHTML = '';
            if (goals.length === 0) {
                container.innerHTML = '<div class="text-center text-muted">No goals yet. Add your first goal!</div>';
                return;
            }
            goals.forEach((goal, idx) => {
                const percent = Math.min(100, Math.round((goal.saved || 0) / goal.target * 100));
                let achievedCard = '';
                let actions = '';
                if ((goal.saved || 0) >= goal.target) {
                    achievedCard = `<div class="goal-achieved-card"><span class="goal-emoji">üèÜ</span>¬°Logro alcanzado! Puedes ir por tu <b>${goal.name}</b></div>`;
                    actions = `<button class="btn btn-sm btn-outline-danger" onclick="deleteGoal(${idx})">Delete</button>`;
                } else {
                    actions = `<button class="btn btn-sm btn-outline-success" onclick="addToGoal(${idx})">Add Saving</button>\n<button class="btn btn-sm btn-outline-danger" onclick="deleteGoal(${idx})">Delete</button>`;
                }
                container.innerHTML += `
                <div class="goal-card">
                    ${achievedCard}
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h4 class="goal-title mb-0">${goal.name}</h4>
                        <div>
                            <span class="badge bg-${percent === 100 ? 'success' : 'primary'} me-1">${percent}%</span>
                            <span class="badge bg-info text-dark">$${(goal.saved || 0).toLocaleString()}</span>
                        </div>
                    </div>
                    <div class="progress-bar mb-2">
                        <div class="progress" style="width:${percent}%;"></div>
                    </div>
                    <div class="mb-2 goal-progress-text" style="font-size:0.98em;">$${(goal.saved || 0).toLocaleString()} / $${Number(goal.target).toLocaleString()}</div>
                    ${goal.deadline ? `<div class="mb-2 text-muted" style="font-size:0.95em;">Deadline: ${goal.deadline}</div>` : ''}
                    <div class="goal-actions">
                        ${actions}
                    </div>
                </div>`;
            });
        }
        // Agregar meta
        document.getElementById('goalForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('goalName').value.trim();
            const target = parseFloat(document.getElementById('goalTarget').value);
            const deadline = document.getElementById('goalDeadline').value;
            const goals = getGoals();
            goals.push({ name, target, deadline, saved: 0 });
            saveGoals(goals);
            this.reset();
            renderGoals();
        });
        // Agregar ahorro a meta
        let savingGoalIdx = null;
        window.addToGoal = function(idx) {
            savingGoalIdx = idx;
            document.getElementById('savingAmount').value = '';
            const modalEl = document.getElementById('addSavingModal');
            const modal = new bootstrap.Modal(modalEl);
            modal.show();
        }
        document.getElementById('addSavingModal').addEventListener('shown.bs.modal', function () {
            document.getElementById('savingAmount').focus();
        });
        document.getElementById('addSavingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const num = parseFloat(document.getElementById('savingAmount').value);
            if (!isNaN(num) && num > 0 && savingGoalIdx !== null) {
                const goals = getGoals();
                goals[savingGoalIdx].saved = (goals[savingGoalIdx].saved || 0) + num;
                saveGoals(goals);
                renderGoals();
                bootstrap.Modal.getInstance(document.getElementById('addSavingModal')).hide();
            }
        });
        // Eliminar meta
        window.deleteGoal = function(idx) {
            if (confirm('Are you sure you want to delete this goal?')) {
                const goals = getGoals();
                goals.splice(idx, 1);
                saveGoals(goals);
                renderGoals();
            }
        }
        document.addEventListener('DOMContentLoaded', renderGoals);
    </script>
</body>
</html> 